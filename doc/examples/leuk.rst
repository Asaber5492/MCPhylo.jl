.. index:: Examples; Leuk: Cox Regression

.. _example-Leuk:

Leuk: Cox Regression
--------------------

An example from OpenBUGS :cite:`openbugs:2014:ex1` and Ezzet and Whitehead :cite:`frierich:1963:E6M` concerning survival in 42 leukemia patients treated with 6-mercaptopurine or placebo. 

Model
^^^^^

Times to death are modelled using the Bayesian Cox proportional hazards model, formulated by Clayton :cite:`clayton:1994:BAF` as

.. math::

	dN_i(t) &\sim \text{Poisson}(I_i(t) dt) \quad\quad i=1,\ldots,42 \\
	I_i(t)dt &= Y_i(t) \exp(\beta Z_i) d\Lambda_0(t) \\
	\beta &\sim \text{Normal}(0, 1000) \\
	d\Lambda_0(t) &\sim \text{Gamma}(c d\Lambda_0^*(t), 1 / c) \\
	d\Lambda_0^*(t) &= r dt \\
	c &= 0.001 \\
	r &= 0.1,
	
where :math:`dN_i(t)` is a counting process increment in time interval :math:`[t, t + dt)` for patient :math:`i`; :math:`Y_i(t)` is an indicator of whether the patient is observed at time :math:`t`; :math:`\bm{z}_i` is a vector of covariates;  and :math:`d\Lambda_0(t)` is the increment in the integrated baseline hazard function during :math:`[t, t + dt)`.
	

Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: leuk.jl
	:language: julia

Results
^^^^^^^

.. code-block:: julia

	Iterations = 2502:10000
	Thinning interval = 2
	Chains = 1,2
	Samples per chain = 3750

	Empirical Posterior Estimates:
	36x6 Array{Any,2}:
	 ""                "Mean"     "SD"       "Naive SE"   "MCSE"          "ESS"
	 "S_treat[1]"     0.983022   0.0140329  0.000162037  0.000638313   483.309
	 "S_treat[2]"     0.966246   0.0208199  0.000240408  0.000744699   781.621
	 "S_treat[3]"     0.956207   0.0245344  0.000283299  0.000946579   671.797
	 "S_treat[4]"     0.936433   0.031637   0.000365312  0.00134705    551.596
	 "S_treat[5]"     0.913982   0.0379829  0.000438589  0.00154683    602.96
	 "S_treat[6]"     0.879372   0.047653   0.00055025   0.00191388    619.946
	 "S_treat[7]"     0.867529   0.0516028  0.000595858  0.00217754    561.582
	 "S_treat[8]"     0.821751   0.06469    0.000746976  0.00268832    579.044
	 "S_treat[9]"     0.805558   0.0686129  0.000792274  0.00286109    575.105
	 "S_treat[10]"    0.771832   0.0769425  0.000888455  0.0032447     562.32
	 "S_treat[11]"    0.735657   0.0855347  0.00098767   0.00374532    521.564
	 "S_treat[12]"    0.7126     0.0895983  0.00103459   0.00358434    624.858
	 "S_treat[13]"    0.691135   0.0946859  0.00109334   0.00398405    564.834
	 "S_treat[14]"    0.664423   0.098857   0.0011415    0.00430813    526.547
	 "S_treat[15]"    0.636423   0.102857   0.00118769   0.00443987    536.696
	 "S_treat[16]"    0.565616   0.112893   0.00130358   0.00497756    514.402
	 "S_treat[17]"    0.471034   0.120103   0.00138683   0.00510817    552.809
	 "S_placebo[1]"   0.92779    0.0501701  0.000579314  0.00231316    470.411
	 "S_placebo[2]"   0.859432   0.0672914  0.000777014  0.00223367    907.571
	 "S_placebo[3]"   0.820805   0.0743428  0.000858436  0.00255436    847.056
	 "S_placebo[4]"   0.748344   0.0854889  0.000987141  0.00328034    679.175
	 "S_placebo[5]"   0.671089   0.0908188  0.00104869   0.00314803    832.288
	 "S_placebo[6]"   0.564656   0.0977834  0.00112911   0.00333978    857.223
	 "S_placebo[7]"   0.532173   0.0996282  0.00115041   0.00363662    750.531
	 "S_placebo[8]"   0.418874   0.0974513  0.00112527   0.00330707    868.336
	 "S_placebo[9]"   0.383211   0.0956878  0.00110491   0.00316676    913.027
	 "S_placebo[10]"  0.317122   0.0912015  0.0010531    0.00290201    987.66
	 "S_placebo[11]"  0.256739   0.0864003  0.000997665  0.00269275   1029.53
	 "S_placebo[12]"  0.223014   0.0822609  0.000949867  0.00219341   1406.52
	 "S_placebo[13]"  0.195547   0.0794305  0.000917185  0.00246664   1036.96
	 "S_placebo[14]"  0.164855   0.0742766  0.000857672  0.00252752    863.604
	 "S_placebo[15]"  0.137033   0.0687638  0.000794016  0.00246522    778.048
	 "S_placebo[16]"  0.083796   0.054749   0.000632187  0.00209242    684.63
	 "S_placebo[17]"  0.0409203  0.0377378  0.000435759  0.00137467    753.631
	 "beta"           1.55206    0.424978   0.00490722   0.0111217    1460.11

	Quantiles:
	36x6 Array{Any,2}:
	 ""                "2.5%"      "25.0%"    "50.0%"    "75.0%"    "97.5%"
	 "S_treat[1]"     0.946214    0.977211   0.986955   0.992865   0.998369
	 "S_treat[2]"     0.915095    0.955732   0.970764   0.981528   0.993124
	 "S_treat[3]"     0.897499    0.943195   0.960671   0.974341   0.989582
	 "S_treat[4]"     0.859907    0.919024   0.941699   0.959578   0.981962
	 "S_treat[5]"     0.823976    0.892499   0.919842   0.941506   0.97167
	 "S_treat[6]"     0.773876    0.850773   0.885178   0.913945   0.955211
	 "S_treat[7]"     0.753182    0.836159   0.873267   0.904856   0.950378
	 "S_treat[8]"     0.680171    0.780967   0.828862   0.86879    0.928834
	 "S_treat[9]"     0.655533    0.762837   0.813277   0.854665   0.919303
	 "S_treat[10]"    0.602685    0.723608   0.779448   0.826763   0.901699
	 "S_treat[11]"    0.550308    0.681882   0.743447   0.797449   0.879907
	 "S_treat[12]"    0.523357    0.654971   0.720928   0.777608   0.864662
	 "S_treat[13]"    0.492287    0.631085   0.699538   0.75892    0.852628
	 "S_treat[14]"    0.45973     0.598393   0.670666   0.735416   0.83825
	 "S_treat[15]"    0.426975    0.566537   0.641229   0.709932   0.822083
	 "S_treat[16]"    0.343874    0.48788    0.566936   0.644919   0.777491
	 "S_treat[17]"    0.246673    0.383396   0.469857   0.555065   0.702809
	 "S_placebo[1]"   0.79979     0.903185   0.939596   0.964924   0.990891
	 "S_placebo[2]"   0.705596    0.819313   0.869353   0.908386   0.963187
	 "S_placebo[3]"   0.656399    0.773124   0.82816    0.876024   0.943371
	 "S_placebo[4]"   0.566079    0.692445   0.754818   0.810412   0.894625
	 "S_placebo[5]"   0.485161    0.609482   0.675431   0.736195   0.836155
	 "S_placebo[6]"   0.369687    0.497149   0.56609    0.632289   0.749329
	 "S_placebo[7]"   0.340286    0.462939   0.532291   0.601897   0.724841
	 "S_placebo[8]"   0.237961    0.349406   0.415076   0.483569   0.620503
	 "S_placebo[9]"   0.209129    0.314948   0.378301   0.44791    0.58211
	 "S_placebo[10]"  0.156247    0.250265   0.311673   0.378897   0.510894
	 "S_placebo[11]"  0.109266    0.193262   0.249638   0.31259    0.443601
	 "S_placebo[12]"  0.084566    0.162032   0.216267   0.276357   0.404484
	 "S_placebo[13]"  0.0650228   0.137219   0.187655   0.24614    0.373112
	 "S_placebo[14]"  0.0479431   0.11043    0.156032   0.209724   0.331684
	 "S_placebo[15]"  0.0342785   0.0861718  0.127243   0.176712   0.295008
	 "S_placebo[16]"  0.012557    0.0429526  0.0721318  0.112032   0.220466
	 "S_placebo[17]"  0.00216784  0.0139597  0.0298228  0.0558223  0.140786
	 "beta"           0.752424    1.25909    1.54072    1.82937    2.41863
