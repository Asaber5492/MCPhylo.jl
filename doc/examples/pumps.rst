.. index:: Examples; Pumps: Gamma-Poisson Hierarchical Model

.. _example-Pumps:

Pumps: Gamma-Poisson Hierarchical Model
---------------------------------------

An example from OpenBUGS :cite:`openbugs:2014:ex` and George *et al.* :cite:`george:1993:CLD` concerning the number of failures of 10 power plant pumps.

Model
^^^^^

Pump failure are modelled as

.. math::

    y_i &\sim \text{Poisson}(\theta_i t_i) \quad\quad i=1,\ldots,10 \\
    \theta_i &\sim \text{Gamma}(\alpha, 1 / \beta) \\
    \alpha &\sim \text{Gamma}(1, 1) \\
    \beta &\sim \text{Gamma}(0.1, 1),

where :math:`y_i` is the number of times that pump :math:`i` failed, and :math:`t_i` is the operation time of the pump (in 1000s of hours).


Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: pumps.jl
    :language: julia

Results
^^^^^^^

.. code-block:: julia

    ## MCMC Simulations

    Iterations = 2502:10000
    Thinning interval = 2
    Chains = 1,2
    Samples per chain = 3750

    Empirical Posterior Estimates:
                  Mean         SD        Naive SE        MCSE         ESS
         beta 0.931315608 0.537637206 0.00620809972 0.02217493312  587.83304
        alpha 0.691860980 0.265829362 0.00306953307 0.00847635787  983.52936
     theta[1] 0.060384575 0.025638910 0.00029605263 0.00033220480 3750.00000
     theta[2] 0.100620864 0.078872848 0.00091074520 0.00129014937 3737.44709
     theta[3] 0.088802891 0.037494957 0.00043295447 0.00047453788 3750.00000
     theta[4] 0.116299572 0.030083966 0.00034737972 0.00037186129 3750.00000
     theta[5] 0.593011791 0.307937371 0.00355575448 0.00635829720 2345.54164
     theta[6] 0.607934929 0.138416420 0.00159829515 0.00173724178 3750.00000
     theta[7] 0.891791097 0.766250517 0.00884789885 0.03817008168  402.99103
     theta[8] 0.844355477 0.669681241 0.00773281290 0.02772424690  583.46761
     theta[9] 1.567012728 0.777217515 0.00897453483 0.03003208698  669.75217
    theta[10] 1.990951397 0.436368103 0.00503874483 0.00927205089 2214.90132

    Quantiles:
                  2.5%       25.0%       50.0%       75.0%      97.5%
         beta 0.184293105 0.543088847 0.834356838 1.20369392 2.314381391
        alpha 0.281382211 0.501394143 0.655005041 0.84119535 1.319660138
     theta[1] 0.021371298 0.042001461 0.056410531 0.07477771 0.120004248
     theta[2] 0.008471647 0.043511570 0.080765640 0.13719263 0.307407921
     theta[3] 0.030609325 0.061598391 0.083902267 0.11051265 0.174202326
     theta[4] 0.064446461 0.094821475 0.113859248 0.13538593 0.181429148
     theta[5] 0.155178964 0.363426425 0.543312061 0.76472677 1.318127748
     theta[6] 0.365631478 0.511616994 0.598314052 0.69414338 0.906808202
     theta[7] 0.065899517 0.363716497 0.681194136 1.18546849 2.910175448
     theta[8] 0.072726085 0.359463692 0.674627415 1.14583558 2.558749491
     theta[9] 0.462541869 1.005287442 1.429687446 1.98629990 3.475055355
    theta[10] 1.234728767 1.681201627 1.966605701 2.26504063 2.941530983

    ## Posterior Predictive Distribution

    Iterations = 2502:10000
    Thinning interval = 2
    Chains = 1,2
    Samples per chain = 3750

    Empirical Posterior Estimates:
             Mean        SD      Naive SE      MCSE       ESS
     y[1]  5.6214667 3.3459536 0.038635744 0.040205640 3750.0000
     y[2]  1.5797333 1.7702148 0.020440680 0.024938825 3750.0000
     y[3]  5.5446667 3.3213063 0.038351142 0.039012280 3750.0000
     y[4] 14.7073333 5.3873137 0.062207341 0.066028477 3750.0000
     y[5]  3.0693333 2.3624148 0.027278816 0.037639989 3750.0000
     y[6] 19.0161333 6.1544231 0.071065156 0.076530838 3750.0000
     y[7]  0.9300000 1.2396659 0.014314429 0.039163782 1001.9362
     y[8]  0.8992000 1.1887926 0.013726994 0.031257581 1446.4433
     y[9]  3.2940000 2.4509246 0.028300840 0.062952578 1515.7685
    y[10] 20.8798667 6.4355075 0.074310840 0.107664392 3572.9045

    Quantiles:
          2.5% 25.0% 50.0% 75.0% 97.5%
     y[1]    1     3     5     8    13
     y[2]    0     0     1     2     6
     y[3]    1     3     5     7    13
     y[4]    6    11    14    18    26
     y[5]    0     1     3     4     9
     y[6]    9    15    19    23    32
     y[7]    0     0     1     1     4
     y[8]    0     0     1     1     4
     y[9]    0     1     3     5     9
    y[10]   10    16    20    25    35
