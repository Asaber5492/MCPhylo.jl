.. index:: Examples; Surgical: Institutional Ranking

.. _example-Surgical:

Surgical: Institutional Ranking
-------------------------------

An example from OpenBUGS :cite:`openbugs:2014:ex` concerning mortality rates in 12 hospitals performing cardiac surgery in infants.

Model
^^^^^

Number of deaths are modelled as

.. math::

    r_i &\sim \text{Binomial}(n_i, p_i) \quad\quad i=1,\ldots,12 \\
    \operatorname{logit}(p_i) &= b_i \\
    b_i &\sim \text{Normal}(\mu, \sigma) \\
    \mu &\sim \text{Normal}(0, 1000) \\
    \sigma^2 &\sim \text{InverseGamma}(0.001, 0001),

where :math:`r_i` is the number of deaths, out of :math:`n_i` operations, at hospital :math:`i`.


Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: surgical.jl
    :language: julia

Results
^^^^^^^

.. code-block:: julia

    Iterations = 2502:10000
    Thinning interval = 2
    Chains = 1,2
    Samples per chain = 3750

    Empirical Posterior Estimates:
                 Mean          SD        Naive SE         MCSE        ESS
          s2  0.194478287 0.173235578 0.002000352156 0.00535539539 1046.3840
        p[1]  0.052805725 0.019802698 0.000228661855 0.00040983701 2334.6746
        p[2]  0.104001890 0.021954871 0.000253513018 0.00031463878 3750.0000
        p[3]  0.070669708 0.017625068 0.000203516751 0.00022047718 3750.0000
        p[4]  0.059118030 0.007905927 0.000091289781 0.00012173024 3750.0000
        p[5]  0.051504980 0.013237162 0.000152849578 0.00022784720 3375.2222
        p[6]  0.069199820 0.014770285 0.000170552556 0.00019567196 3750.0000
        p[7]  0.067117588 0.016030864 0.000185108468 0.00018177288 3750.0000
        p[8]  0.123097365 0.021932619 0.000253256064 0.00035470478 3750.0000
        p[9]  0.070410452 0.014853390 0.000171512180 0.00016685321 3750.0000
       p[10]  0.078694851 0.019846039 0.000229162317 0.00024205758 3750.0000
       p[11]  0.102801934 0.017695065 0.000204325015 0.00023333460 3750.0000
       p[12]  0.068715136 0.011924619 0.000137693642 0.00016046750 3750.0000
          mu -2.550741500 0.156745104 0.001809936556 0.00286379932 2995.7309
    pop_mean  0.073072811 0.010440709 0.000120558917 0.00018532415 3173.9195

    Quantiles:
                 2.5%         25.0%        50.0%        75.0%        97.5%
          s2  0.030928772  0.090703538  0.147636980  0.240567904  0.622185293
        p[1]  0.016802350  0.038901688  0.052307730  0.065443005  0.093672079
        p[2]  0.067525635  0.087996977  0.101695407  0.117362817  0.153502682
        p[3]  0.039638876  0.058578620  0.069377099  0.081109022  0.109382011
        p[4]  0.044484777  0.053534322  0.058953960  0.064281904  0.075022497
        p[5]  0.027654785  0.042219334  0.050835609  0.060121701  0.079394973
        p[6]  0.043011130  0.058938078  0.068255749  0.078435798  0.101892717
        p[7]  0.038490237  0.056074218  0.066107926  0.076930127  0.101395608
        p[8]  0.084453927  0.107222812  0.121811458  0.137218683  0.168716093
        p[9]  0.044306927  0.059573839  0.069798505  0.079936385  0.101828273
       p[10]  0.044684838  0.064689236  0.076790598  0.090555308  0.122804460
       p[11]  0.072230394  0.090317164  0.101265471  0.114039968  0.140922834
       p[12]  0.047186886  0.060534280  0.068033520  0.076252083  0.093880188
          mu -2.886807928 -2.641133981 -2.542990063 -2.451692945 -2.265183157
    pop_mean  0.052809561  0.066537569  0.072898833  0.079314836  0.094047829
