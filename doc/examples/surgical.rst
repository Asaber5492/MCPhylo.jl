.. index:: Examples; Surgical: Institutional Ranking

.. _example-Surgical:

Surgical: Institutional Ranking
-------------------------------

An example from OpenBUGS :cite:`openbugs:2014:ex1` concerning mortality rates in 12 hospitals performing cardiac surgery in infants.

Model
^^^^^

Number of deaths are modelled as

.. math::

    r_i &\sim \text{Binomial}(n_i, p_i) \quad\quad i=1,\ldots,12 \\
    \operatorname{logit}(p_i) &= b_i \\
    b_i &\sim \text{Normal}(\mu, \sigma) \\
    \mu &\sim \text{Normal}(0, 1000) \\
    \sigma^2 &\sim \text{InverseGamma}(0.001, 0001),

where :math:`r_i` is the number of deaths, out of :math:`n_i` operations, at hospital :math:`i`.


Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: surgical.jl
    :language: julia

Results
^^^^^^^

.. code-block:: julia

    Iterations = 2502:10000
    Thinning interval = 2
    Chains = 1,2
    Samples per chain = 3750

    Empirical Posterior Estimates:
    16x6 Array{Any,2}:
     ""            "Mean"     "SD"        "Naive SE"   "MCSE"          "ESS"
     "mu"        -2.55074    0.156745    0.00180994   0.00321831   2372.1
     "pop_mean"   0.0730728  0.0104407   0.000120559  0.000210412  2462.17
     "p[1]"       0.0528057  0.0198027   0.000228662  0.000441299  2013.65
     "p[2]"       0.104002   0.0219549   0.000253513  0.000355532  3813.32
     "p[3]"       0.0706697  0.0176251   0.000203517  0.000209801  7057.44
     "p[4]"       0.059118   0.00790593  9.12898e-5   0.000129088  3750.88
     "p[5]"       0.051505   0.0132372   0.00015285   0.00025127   2775.29
     "p[6]"       0.0691998  0.0147703   0.000170553  0.000201847  5354.67
     "p[7]"       0.0671176  0.0160309   0.000185108  0.000192121  6962.47
     "p[8]"       0.123097   0.0219326   0.000253256  0.000387867  3197.54
     "p[9]"       0.0704105  0.0148534   0.000171512  0.00018333   6564.26
     "p[10]"      0.0786949  0.019846    0.000229162  0.000249277  6338.45
     "p[11]"      0.102802   0.0176951   0.000204325  0.0002605    4614.11
     "p[12]"      0.0687151  0.0119246   0.000137694  0.000158453  5663.56
     "s2"         0.194478   0.173236    0.00200035   0.00563357    945.598

    Quantiles:
    16x6 Array{Any,2}:
     ""            "2.5%"      "25.0%"     "50.0%"     "75.0%"     "97.5%"
     "mu"        -2.88681    -2.64113    -2.54299    -2.45169    -2.26518
     "pop_mean"   0.0528096   0.0665376   0.0728988   0.0793148   0.0940478
     "p[1]"       0.0168024   0.0389017   0.0523077   0.065443    0.0936721
     "p[2]"       0.0675256   0.087997    0.101695    0.117363    0.153503
     "p[3]"       0.0396389   0.0585786   0.0693771   0.081109    0.109382
     "p[4]"       0.0444848   0.0535343   0.058954    0.0642819   0.0750225
     "p[5]"       0.0276548   0.0422193   0.0508356   0.0601217   0.079395
     "p[6]"       0.0430111   0.0589381   0.0682557   0.0784358   0.101893
     "p[7]"       0.0384902   0.0560742   0.0661079   0.0769301   0.101396
     "p[8]"       0.0844539   0.107223    0.121811    0.137219    0.168716
     "p[9]"       0.0443069   0.0595738   0.0697985   0.0799364   0.101828
     "p[10]"      0.0446848   0.0646892   0.0767906   0.0905553   0.122804
     "p[11]"      0.0722304   0.0903172   0.101265    0.11404     0.140923
     "p[12]"      0.0471869   0.0605343   0.0680335   0.0762521   0.0938802
     "s2"         0.0309288   0.0907035   0.147637    0.240568    0.622185
