.. index:: Examples; Pollution: Bayesian Variable Selection

.. _example-Pollution:

Pollution: Bayesian Variable Selection
--------------------------------------

Data from McDonald and Schwing :cite:`mcdonald:1973:pol` that include 15 independent variables and a measure of mortality on 60 U.S. metropolitan areas in 1959-1961. Originally, the data were used to illustrate ridge regression (the full covariate matrix has a huge condition number).

Model
^^^^^

.. math::

    y_{i} &\sim \text{Normal}(\mu_i, \sigma) \quad\quad i=1, \ldots, 60 \\
    \mu_i &= \alpha + \sum_{j=1}^{15} \theta_j x_{ij} \\
    \theta_j &= \beta_j \gamma_j \\
    \alpha &\sim \text{Normal}(\mu_\alpha, \sigma_\alpha) \\
    \beta_j | \gamma_j = 1 &\sim \text{Normal}(\mu_\beta, \sigma_\beta) \\
    \beta_j | \gamma_j = 0 &\sim \text{Normal}(0, 10^{12}) \\
    \gamma_j &\sim \text{Bernoulli}(0.5) \\
    \mu_\alpha, \mu_\beta &\sim \text{Normal}(0, 1000) \\
    \sigma_\alpha^2, \sigma_\beta^2, \sigma^2 &\sim \text{InverseGamma}(0.0001, 0.0001) \\


Analysis Program
^^^^^^^^^^^^^^^^

.. literalinclude:: pollution.jl
    :language: julia

Results
^^^^^^^

.. code-block:: julia

    ## Discrete Gibbs Sampling

    Iterations = 1001:10000
    Thinning interval = 1
    Chains = 1,2,3,4
    Samples per chain = 9000

    Empirical Posterior Estimates:
                  Mean          SD       Naive SE      MCSE         ESS
       sigma2 1872.3952308 969.7126808 5.110834579 51.171801340  359.10772
     gamma[1]    1.0000000   0.0000000 0.000000000  0.000000000 9000.00000
     gamma[2]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
     gamma[3]    0.5000000   0.5000069 0.002635268  0.026388991  359.00997
     gamma[4]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
     gamma[5]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
     gamma[6]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
     gamma[7]    0.2500000   0.4330187 0.002282209  0.022853536  359.00997
     gamma[8]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
     gamma[9]    0.2500000   0.4330187 0.002282209  0.022853536  359.00997
    gamma[10]    0.2500000   0.4330187 0.002282209  0.022853536  359.00997
    gamma[11]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
    gamma[12]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
    gamma[13]    0.7500000   0.4330187 0.002282209  0.022853536  359.00997
    gamma[14]    0.5000000   0.5000069 0.002635268  0.026388991  359.00997
    gamma[15]    0.5000000   0.5000069 0.002635268  0.026388991  359.00997
     theta[1]   28.5659451  11.0549131 0.058264508  0.543118788  414.30580
     theta[2]  -11.4834865  14.4397471 0.076104149  0.740367959  380.38549
     theta[3]    9.0622502  11.7048212 0.061689824  0.609227198  369.12291
     theta[4]    2.2054442  10.5294351 0.055494996  0.534085357  388.67696
     theta[5]   18.4493254  11.4047690 0.060108410  0.594528356  367.98307
     theta[6]    2.6696258   6.7785739 0.035726221  0.321928367  443.36170
     theta[7]    1.2402045   3.1859274 0.016791312  0.139119258  524.44174
     theta[8]   13.5179434  10.1229055 0.053352396  0.507681141  397.58345
     theta[9]    6.6915844  11.8905349 0.062668622  0.626777494  359.89515
    theta[10]    1.3783115   4.3480791 0.022916389  0.200010008  472.59749
    theta[11]   11.7671223  10.9812394 0.057876213  0.537003047  418.16648
    theta[12]   -9.0668239  22.6460622 0.119355228  1.180981333  367.70482
    theta[13]   23.4368025  20.9933351 0.110644591  1.095160746  367.45752
    theta[14]   11.9551281  12.7029868 0.066950619  0.651088126  380.65553
    theta[15]    8.6023199  11.4418730 0.060303966  0.587159172  379.73668
        alpha    7.5663182  19.2021200 0.101204059  1.010086161  361.39448

    Quantiles:
                  2.5%         25.0%         50.0%        75.0%        97.5%
       sigma2 957.33375930 1201.98100557 1440.8057544 2097.6025842 3852.3809096
     gamma[1]   1.00000000    1.00000000    1.0000000    1.0000000    1.0000000
     gamma[2]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
     gamma[3]   0.00000000    0.00000000    0.5000000    1.0000000    1.0000000
     gamma[4]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
     gamma[5]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
     gamma[6]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
     gamma[7]   0.00000000    0.00000000    0.0000000    0.2500000    1.0000000
     gamma[8]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
     gamma[9]   0.00000000    0.00000000    0.0000000    0.2500000    1.0000000
    gamma[10]   0.00000000    0.00000000    0.0000000    0.2500000    1.0000000
    gamma[11]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
    gamma[12]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
    gamma[13]   0.00000000    0.75000000    1.0000000    1.0000000    1.0000000
    gamma[14]   0.00000000    0.00000000    0.5000000    1.0000000    1.0000000
    gamma[15]   0.00000000    0.00000000    0.5000000    1.0000000    1.0000000
     theta[1]   9.96273540   20.07173056   29.2049503   36.0077616   50.5816650
     theta[2] -43.59110506  -20.23437881   -5.6788255    0.0000000    2.8207685
     theta[3]   0.00000000    0.00000000    0.0000000   16.7672085   33.7291874
     theta[4] -15.78926617   -4.55386820    0.0000000   10.2853861   21.7939068
     theta[5]   0.00000000    8.44690459   22.3279210   25.3846291   36.0429942
     theta[6] -11.32009121   -0.63877889    0.0000000    6.4916120   17.9244034
     theta[7]  -0.96186506    0.00000000    0.0000000    0.0000000   10.9067203
     theta[8]   0.00000000    0.00000000   15.1470090   19.6630080   34.2397139
     theta[9]   0.00000000    0.00000000    0.0000000    3.8903324   35.6238981
    theta[10]  -3.64363587    0.00000000    0.0000000    0.0000000   15.3332328
    theta[11]  -1.41505423    0.00000000   10.8053432   19.9574806   34.1335690
    theta[12] -47.76379123  -30.97234907    0.0000000    4.0204465   27.5061050
    theta[13]   0.00000000    0.00000000   17.5636887   44.1151224   58.5492375
    theta[14]   0.00000000    0.00000000    0.0000000   24.3560365   33.2452281
    theta[15]   0.00000000    0.00000000    0.0000000   17.7220435   32.5324760
        alpha -27.38728958   -3.73626201    9.4890781   20.4709663   38.1135924
